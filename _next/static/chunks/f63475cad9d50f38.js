(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,21662,e=>{"use strict";let t="embris_conversations_index",n="embris_active_conv",r="embris_conv_";function i(e){try{return localStorage.getItem(e)}catch{return null}}function o(e,t){try{localStorage.setItem(e,t)}catch{}}function a(e){try{localStorage.removeItem(e)}catch{}}function c(){let e=i(t);if(!e)return[];try{return JSON.parse(e)}catch{return[]}}function s(e){o(t,JSON.stringify([...e].sort((e,t)=>t.updatedAt-e.updatedAt)))}function l(){return i(n)}function u(e){o(n,e)}function d(e){let t=`conv_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,n=Date.now(),r=e?e.slice(0,60):"New conversation",i={id:t,title:p(e||""),createdAt:n,updatedAt:n,preview:r},o=c();return o.unshift(i),s(o),u(t),i}function f(e,t){let n=c(),r=n.findIndex(t=>t.id===e);-1!==r&&(n[r]={...n[r],...t},s(n))}function v(e){let t=c().filter(t=>t.id!==e);s(t),a(`${r}${e}`),l()===e&&(t.length>0?u(t[0].id):a(n))}function g(e){let t=i(`${r}${e}`);if(!t)return[];try{return JSON.parse(t)}catch{return[]}}function h(e,t){o(`${r}${e}`,JSON.stringify(t.slice(-200)));let n=[...t].reverse().find(e=>"user"===e.role);f(e,{updatedAt:Date.now(),preview:n?n.content.slice(0,60):""})}function m(e){a(`${r}${e}`),f(e,{updatedAt:Date.now(),preview:""})}function p(e){if(!e.trim())return"New Chat";let t=e.trim().replace(/[^\w\s,.?!'-]/g,"").trim();if(t.length<=40)return t;let n=t.slice(0,40),r=n.lastIndexOf(" ");return r>20?n.slice(0,r)+"…":n+"…"}function C(e,t){f(e,{title:p(t)})}function y(){let e=i("ember_chat_history");if(!e)return null;try{let t=JSON.parse(e);if(!t||0===t.length)return null;if(c().length>0)return l();let n=t.find(e=>"user"===e.role),r=d(n?.content||"");return h(r.id,t),r.id}catch{return null}}function A(){let e=y();if(e)return e;let t=l();if(t&&c().some(e=>e.id===t))return t;let n=c();return n.length>0?(u(n[0].id),n[0].id):d().id}e.s(["clearConversationMessages",()=>m,"createConversation",()=>d,"deleteConversation",()=>v,"ensureActiveConversation",()=>A,"generateTitle",()=>p,"getActiveConversationId",()=>l,"getConversationIndex",()=>c,"getConversationMessages",()=>g,"migrateFromLegacy",()=>y,"saveConversationMessages",()=>h,"setActiveConversationId",()=>u,"updateConversationMeta",()=>f,"updateConversationTitle",()=>C])},28760,e=>{e.v(t=>Promise.all(["static/chunks/bd18d573302146f5.js"].map(t=>e.l(t))).then(()=>t(51694)))},91991,e=>{e.v(e=>Promise.resolve().then(()=>e(21662)))},73378,e=>{e.v(t=>Promise.all(["static/chunks/0cbbe76af706843a.js"].map(t=>e.l(t))).then(()=>t(73134)))}]);